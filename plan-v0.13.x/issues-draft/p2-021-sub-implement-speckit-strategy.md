# ðŸ”§ P2-021: Implement SpecKitStrategy [parallel]

> **Parent**: #696
> **Labels**: `phase-2`, `priority-high`, `parallel`, `copilot-suitable`, `mcp-serena`
> **Milestone**: M3: Domain Layer
> **Estimate**: 4 hours
> **Depends On**: P2-015
> **Blocks**: P2-025, P2-027

## Context

SpecKitStrategy is the premium output format â€” the signature output of the refactored project. It generates a complete "Spec Kit" folder with all necessary documentation for implementing a feature.

## Task Description

Implement SpecKitStrategy:

**Create `src/strategies/speckit-strategy.ts`:**
```typescript
import type { OutputStrategy, OutputArtifacts, OutputApproach, OutputDocument } from './output-strategy.js';

export class SpecKitStrategy implements OutputStrategy<any> {
  readonly approach = OutputApproach.SPECKIT;

  render(result: any): OutputArtifacts {
    const title = result.metadata?.title ?? 'feature';
    const slug = this.slugify(title);

    return {
      primary: this.generateReadme(result, slug),
      secondary: [
        this.generateSpec(result, slug),
        this.generatePlan(result, slug),
        this.generateTasks(result, slug),
        this.generateAdr(result, slug),
        this.generateRoadmap(result, slug),
      ],
    };
  }

  supports(domainType: string): boolean {
    return ['SessionState'].includes(domainType);
  }

  private generateReadme(result: any, slug: string): OutputDocument {
    const content = `# Spec Kit: ${result.metadata?.title}

This Spec Kit contains the complete documentation for implementing this feature.

## Contents

- [spec.md](./spec.md) - Full specification
- [plan.md](./plan.md) - Implementation plan
- [tasks.md](./tasks.md) - Detailed task breakdown
- [adr.md](./adr.md) - Architecture decision record
- [roadmap.md](./roadmap.md) - Timeline and milestones

## Quick Start

1. Read the specification (spec.md)
2. Review the ADR for design decisions
3. Follow the implementation plan
4. Execute tasks in order

## Status

- **Created**: ${new Date().toISOString().split('T')[0]}
- **Status**: Draft
- **Owner**: @copilot

---
*Generated by design-assistant with SpecKit strategy*
`;

    return {
      name: `${slug}/README.md`,
      content,
      format: 'markdown',
    };
  }

  private generateSpec(result: any, slug: string): OutputDocument {
    // Full specification document
  }

  private generatePlan(result: any, slug: string): OutputDocument {
    // Implementation plan
  }

  private generateTasks(result: any, slug: string): OutputDocument {
    // Task breakdown
  }

  private generateAdr(result: any, slug: string): OutputDocument {
    // Architecture decision record
  }

  private generateRoadmap(result: any, slug: string): OutputDocument {
    // Timeline and milestones
  }

  private slugify(title: string): string {
    return title.toLowerCase().replace(/[^a-z0-9]+/g, '-').slice(0, 50);
  }
}
```

## Acceptance Criteria

- [ ] File created: `src/strategies/speckit-strategy.ts`
- [ ] Generates folder structure with README
- [ ] 5 secondary documents (spec, plan, tasks, adr, roadmap)
- [ ] Documents are cross-referenced
- [ ] Unit tests

## Files to Create

- `src/strategies/speckit-strategy.ts`
- `tests/vitest/strategies/speckit-strategy.spec.ts`

## Files to Modify

- `src/strategies/index.ts`

## Verification

```bash
npm run build && npm run test:vitest -- speckit-strategy
```

## References

- [SPEC-001: Output Strategy Layer](https://github.com/Anselmoo/mcp-ai-agent-guidelines/blob/development/plan-v0.13.x/specs/SPEC-001-output-strategy-layer.md) Â§4.5
- [SPEC-005: Spec-Kit Integration](https://github.com/Anselmoo/mcp-ai-agent-guidelines/blob/development/plan-v0.13.x/specs/SPEC-005-speckit-integration.md)
- [TASKS Phase 2](https://github.com/Anselmoo/mcp-ai-agent-guidelines/blob/development/plan-v0.13.x/tasks/TASKS-phase-2-domain-extraction.md) P2-021
