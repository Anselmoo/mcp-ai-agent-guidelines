# ðŸ”§ P2-018: Implement ADRStrategy [parallel]

> **Parent**: [002-parent-phase2-domain-extraction.md](https://github.com/Anselmoo/mcp-ai-agent-guidelines/blob/development/plan-v0.13.x/issues-draft/002-parent-phase2-domain-extraction.md)
> **Labels**: `phase-2`, `priority-high`, `parallel`, `copilot-suitable`, `mcp-serena`
> **Milestone**: M3: Domain Layer
> **Estimate**: 4 hours
> **Depends On**: P2-015
> **Blocks**: P2-025, P2-027

## Context

ADRStrategy generates Architecture Decision Records following the Michael Nygard format â€” the industry standard for documenting architectural decisions.

## Task Description

Implement ADRStrategy:

**Create `src/strategies/adr-strategy.ts`:**
```typescript
import type { OutputStrategy, OutputArtifacts, OutputApproach } from './output-strategy.js';

export class ADRStrategy implements OutputStrategy<any> {
  readonly approach = OutputApproach.ADR;

  render(result: any): OutputArtifacts {
    const adrNumber = this.generateAdrNumber();
    const title = result.metadata?.title ?? 'Untitled Decision';

    const content = `# ADR-${adrNumber}: ${title}

## Status

**Proposed** | _${new Date().toISOString().split('T')[0]}_

## Context

${this.extractContext(result)}

## Decision

${this.extractDecision(result)}

## Consequences

### Positive

${this.extractPositiveConsequences(result)}

### Negative

${this.extractNegativeConsequences(result)}

### Neutral

${this.extractNeutralConsequences(result)}

## References

${this.extractReferences(result)}

---
*ADR generated by design-assistant*
`;

    return {
      primary: {
        name: `ADR-${adrNumber}-${this.slugify(title)}.md`,
        content,
        format: 'markdown',
      },
    };
  }

  supports(domainType: string): boolean {
    return ['SessionState', 'PromptResult'].includes(domainType);
  }

  private generateAdrNumber(): string {
    // Generate sequential ADR number
    return String(Date.now()).slice(-4).padStart(4, '0');
  }

  private slugify(title: string): string {
    return title.toLowerCase().replace(/[^a-z0-9]+/g, '-').slice(0, 50);
  }

  private extractContext(result: any): string {
    // Extract context from domain result
  }

  private extractDecision(result: any): string {
    // Extract decision statement
  }

  // ... other extraction methods
}
```

## Acceptance Criteria

- [ ] File created: `src/strategies/adr-strategy.ts`
- [ ] Michael Nygard format (Status, Context, Decision, Consequences)
- [ ] Consequences split into Positive/Negative/Neutral
- [ ] ADR numbering system
- [ ] Unit tests

## Files to Create

- `src/strategies/adr-strategy.ts`
- `tests/vitest/strategies/adr-strategy.spec.ts`

## Files to Modify

- `src/strategies/index.ts`

## Verification

```bash
npm run build && npm run test:vitest -- adr-strategy
```

## References

- [SPEC-001: Output Strategy Layer](https://github.com/Anselmoo/mcp-ai-agent-guidelines/blob/development/plan-v0.13.x/specs/SPEC-001-output-strategy-layer.md) Â§4.3
- [ADR format](https://cognitect.com/blog/2011/11/15/documenting-architecture-decisions)
- [TASKS Phase 2](https://github.com/Anselmoo/mcp-ai-agent-guidelines/blob/development/plan-v0.13.x/tasks/TASKS-phase-2-domain-extraction.md) P2-018
